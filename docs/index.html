---

title: memery


keywords: fastai
sidebar: home_sidebar

summary: "Search over large image datasets with natural language and computer vision!"
description: "Search over large image datasets with natural language and computer vision!"
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2><p>The necessary CLIP and torch packages will be installed by pip. You might want to make sure you have a sane CUDA environment before and after this step if you're trying to use GPU. If you don't have a GPU, <code>memery</code> should still work on your CPU.</p>
<p>If you have any trouble please <strong>open an issue on Github</strong>! I want to make this package useful for as many people as possible. Help me know what's going wrong :)</p>
<p><code>pip install memery</code></p>
<p>If you don't have a GPU for PyTorch, this command might help</p>
<p>`pip install torch==1.7.1+cpu torchvision==0.8.2+cpu torchaudio==0.7.2 -f <a href="https://download.pytorch.org/whl/torch_stable.html">https://download.pytorch.org/whl/torch_stable.html</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Use-GUI">Use GUI<a class="anchor-link" href="#Use-GUI"> </a></h3><p>The browser GUI is a Streamlit app. You can run it from the command line with</p>
<p><code>memery serve</code></p>
<p>or set up a desktop shortcut to use it from your menu.</p>
<p>If you're in a Jupyter environment, you can summon the GUI directly into an output cell like this:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">memery.gui</span> <span class="kn">import</span> <span class="n">appPage</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">appPage</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre>&lt;memery.gui.appPage at 0x7f6c0e7c80d0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Use-CLI">Use CLI<a class="anchor-link" href="#Use-CLI"> </a></h3><p>From the command line, you can use <code>memery</code> on any folder and it will search for images recursively, returning a list object to stdout.</p>
<p>Pass the --n flag to control how many images are returned (default 10).</p>
<p><code>memery rank PATH/TO/IMAGE/FOLDER 'query' --n 20</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Use-as-a-library">Use as a library<a class="anchor-link" href="#Use-as-a-library"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Simply use <a href="/memery/core.html#queryFlow"><code>queryFlow</code></a> to search over a folder recursively! The folder will be indexed, if an index doesn't already exist. Then any new images will be CLIP-encoded, an Annoy treemap built, and a list of ranked filenames returned.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">memery.core</span> <span class="kn">import</span> <span class="n">queryFlow</span>
<span class="kn">from</span> <span class="nn">memery.gui</span> <span class="kn">import</span> <span class="n">get_grid</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ranked</span> <span class="o">=</span> <span class="n">queryFlow</span><span class="p">(</span><span class="s1">&#39;./images&#39;</span><span class="p">,</span> <span class="s1">&#39;dad joke&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ranked</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

